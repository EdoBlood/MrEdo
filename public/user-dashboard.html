<!DOCTYPE html>
<html>
<head>
  <title>User Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
</head>
<body class="p-4">
  <h2>Welcome to Your Dashboard</h2>
  <div id="userInfo" class="mb-4"></div>
  <div>
    <h4>Your Referral Link</h4>
    <p id="referralLink"></p>
  </div>

  <script>
    const supabase = supabase.createClient(
      'https://exebxtduexxgckezhdky.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV4ZWJ4dGR1ZXh4Z2NrZXpoZGt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NDQ4MTYsImV4cCI6MjA3NDAyMDgxNn0.Jq6TWKe53uuBFd0ECuefyluZxRCrqaAKrp6ZJu8DSbA'
    );

    async function loadUser() {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return;

      const { data } = await supabase.from('users').select('*').eq('id', user.id).single();
      if (data) {
        document.getElementById('userInfo').innerHTML = `
          <p><strong>Email:</strong> ${data.email}</p>
          <p><strongLevel:</strong> ${data.level || 'Not set'}</p>
          <p><strong>Earnings:</strong> â‚¦${data.earnings || 0}</p>
        `;
        document.getElementById('referralLink').textContent = `${window.location.origin}/?ref=${data.referral_code}`;
      }
    }

    loadUser();
  </script>
</body>
</html>
